{% extends "admin/change_form.html" %}
{% load i18n admin_urls %}

{% block object-tools-items %}
{{ block.super }}
{% if original and original.status == 'pending' %}
<li>
    <a href="{% url 'admin:local_chefs_servicearearequest_partial_approve' original.pk %}" 
       class="button" 
       style="background: #5bc0de; color: #fff;">
        üîÄ Partial Approve
    </a>
</li>
{% endif %}
{% endblock %}

{% block after_field_sets %}
{{ block.super }}

{% if original and original.status == 'pending' %}
<div style="margin: 20px 0; padding: 15px; background: #e7f3ff; border: 1px solid #79aec8; border-radius: 4px;">
    <h3 style="margin: 0 0 10px 0; color: #417690;">Quick Actions</h3>
    <p style="margin: 0 0 10px 0; color: #666;">
        This request is pending review. You can:
    </p>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <a href="{% url 'admin:local_chefs_servicearearequest_partial_approve' original.pk %}" 
           class="button" 
           style="background: #5bc0de; color: #fff; padding: 8px 16px; border-radius: 4px; text-decoration: none;">
            üîÄ Partial Approve (select areas)
        </a>
        <span style="color: #888; line-height: 36px;">
            Or change the Status dropdown above to "Approved" or "Rejected" for full approval/rejection.
        </span>
    </div>
</div>
{% endif %}

{% if original and original.status == 'partially_approved' %}
<div style="margin: 20px 0; padding: 15px; background: #d9edf7; border: 1px solid #5bc0de; border-radius: 4px;">
    <h3 style="margin: 0 0 10px 0; color: #31708f;">Partial Approval Summary</h3>
    {% with summary=original.approval_summary %}
    {% if summary %}
    <div style="display: flex; gap: 30px; margin-bottom: 10px;">
        <div style="color: #3c763d;">
            <strong>‚úÖ Approved:</strong> {{ summary.approved_areas }} areas ({{ summary.approved_codes }} postal codes)
        </div>
        <div style="color: #a94442;">
            <strong>‚ùå Rejected:</strong> {{ summary.rejected_areas }} areas ({{ summary.rejected_codes }} postal codes)
        </div>
    </div>
    {% endif %}
    {% endwith %}
    
    {% if original.approved_areas.exists %}
    <div style="margin-top: 10px;">
        <strong>Approved Areas:</strong>
        <ul style="margin: 5px 0; padding-left: 20px;">
        {% for area in original.approved_areas.all %}
            <li style="color: #3c763d;">{{ area.name }} ({{ area.postal_code_count }} codes)</li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    {% with rejected=original.rejected_areas %}
    {% if rejected %}
    <div style="margin-top: 10px;">
        <strong>Rejected Areas:</strong>
        <ul style="margin: 5px 0; padding-left: 20px;">
        {% for area in rejected %}
            <li style="color: #a94442;">{{ area.name }} ({{ area.postal_code_count }} codes)</li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}
    {% endwith %}
</div>
{% endif %}
{% endblock %}







